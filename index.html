<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Controle de DÃ­vidas</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f2f4f8;
      padding: 20px;
      max-width: 700px;
      margin: auto;
    }

    h1 {
      text-align: center;
    }

    .card {
      background: #fff;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .progress {
      background: #eee;
      border-radius: 10px;
      overflow: hidden;
      height: 10px;
      margin-top: 8px;
    }

    .progress-bar {
      height: 100%;
      background: #4caf50;
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }

    select, input, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 16px;
    }

    button {
      background: #4caf50;
      color: #fff;
      border: none;
      cursor: pointer;
      margin-top: 15px;
    }

    button:hover {
      background: #43a047;
    }

    small {
      color: #666;
    }

    footer {
      text-align: center;
      margin-top: 30px;
      font-size: 12px;
      color: #777;
    }
  </style>
</head>

<body>

  <h1>ðŸ’¸ Controle de DÃ­vidas</h1>

  <div id="lista"></div>

  <div class="card" id="formPagamento">
    <h2>Registrar Pagamento</h2>

    <label>IrmÃ£o</label>
    <select id="irmao"></select>

    <label>Valor pago (R$)</label>
    <input type="number" id="valor" placeholder="Ex: 200" />

    <button onclick="registrarPagamento()">Registrar pagamento</button>
  </div>

  <div class="card">
    <h2>ðŸ“œ HistÃ³rico de Pagamentos</h2>
    <div id="historico"></div>
  </div>

  <footer>
    Sistema familiar â€” versÃ£o somente leitura para curiosos ðŸ˜„
  </footer>

  <script>
    // ðŸ” DEFINA SUA SENHA AQUI
    const SENHA_ADMIN = "7952"; // MUDE ISSO

    // ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦ IRMÃƒOS CADASTRADOS NO CÃ“DIGO
    const irmaos = [
      { id: 1, nome: "Abilio", divida: 40000 },
      { id: 2, nome: "Alyson", divida: 51000 }
    ];

    // ðŸ”Ž MODO SOMENTE LEITURA (?readonly=1)
    const params = new URLSearchParams(window.location.search);
    const somenteLeitura = params.get("readonly") === "1";

    let pagamentos = JSON.parse(localStorage.getItem("pagamentos")) || [];

    function carregar() {
      const lista = document.getElementById("lista");
      const select = document.getElementById("irmao");
      const historico = document.getElementById("historico");

      lista.innerHTML = "";
      select.innerHTML = "";
      historico.innerHTML = "";

      irmaos.forEach(i => {
        const pagos = pagamentos.filter(p => p.irmaoId === i.id);
        const totalPago = pagos.reduce((a, b) => a + b.valor, 0);
        const falta = i.divida - totalPago;
        const progresso = Math.min((totalPago / i.divida) * 100, 100);

        lista.innerHTML += `
          <div class="card">
            <strong>${i.nome}</strong><br>
            DÃ­vida: R$ ${i.divida}<br>
            Pago: R$ ${totalPago}<br>
            Falta: R$ ${falta}

            <div class="progress">
              <div class="progress-bar" style="width: ${progresso}%"></div>
            </div>
          </div>
        `;

        select.innerHTML += `<option value="${i.id}">${i.nome}</option>`;
      });

      pagamentos
        .slice()
        .reverse()
        .forEach(p => {
          const irmao = irmaos.find(i => i.id === p.irmaoId);
          historico.innerHTML += `
            <p>
              <strong>${p.quem}</strong> registrou 
              <strong>R$ ${p.valor}</strong> 
              de ${irmao.nome}<br>
              <small>${p.data}</small>
            </p>
          `;
        });

      if (somenteLeitura) {
        document.getElementById("formPagamento").style.display = "none";
      }
    }

    function registrarPagamento() {
      const senha = prompt("Digite a senha para registrar o pagamento:");
      if (senha !== SENHA_ADMIN) {
        alert("Senha incorreta. Pagamento nÃ£o registrado.");
        return;
      }

      const irmaoId = Number(document.getElementById("irmao").value);
      const valor = Number(document.getElementById("valor").value);

      if (!valor || valor <= 0) {
        alert("Digite um valor vÃ¡lido");
        return;
      }

      const quem = prompt("Quem fez o depÃ³sito?");
      if (!quem) {
        alert("Nome obrigatÃ³rio");
        return;
      }

      const data = new Date().toLocaleString("pt-BR");

      pagamentos.push({
        irmaoId,
        valor,
        quem,
        data
      });

      localStorage.setItem("pagamentos", JSON.stringify(pagamentos));
      document.getElementById("valor").value = "";
      carregar();
    }

    carregar();
  </script>

</body>
</html>

